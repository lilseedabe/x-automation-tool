# ğŸš€ Render ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆè¨­å®š
# Xè‡ªå‹•åå¿œãƒ„ãƒ¼ãƒ« - VPS PostgreSQLå¯¾å¿œç‰ˆ

services:
  # çµ±åˆ Web ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ + ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰
  - type: web
    name: x-automation-tool
    env: python
    buildCommand: |
      # Pythonä¾å­˜é–¢ä¿‚
      pip install --upgrade pip
      pip install -r requirements.txt
      
      # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆpackage-lock.jsonå•é¡Œã‚’å›é¿ï¼‰
      cd frontend
      rm -f package-lock.json
      npm install
      npm run build
      cd ..
    startCommand: |
      python -m uvicorn app:app --host 0.0.0.0 --port $PORT
    envVars:
      # Pythonè¨­å®š
      - key: PYTHON_VERSION
        value: 3.11
      
      # Node.jsè¨­å®š
      - key: NODE_VERSION
        value: 18
      
      # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
      - key: APP_ENV
        value: production
      
      # VPS PostgreSQLæ¥ç¶šè¨­å®šï¼ˆæ‰‹å‹•è¨­å®šï¼‰
      - key: DATABASE_URL
        sync: false  # æ‰‹å‹•ã§è¨­å®š
      
      # ã¾ãŸã¯å€‹åˆ¥è¨­å®šï¼ˆã“ã¡ã‚‰ã‚‚æ‰‹å‹•è¨­å®šï¼‰
      - key: DB_HOST
        sync: false
      - key: DB_PORT
        value: 5432
      - key: DB_NAME
        value: x_automation_db
      - key: DB_USER
        value: x_automation_user
      - key: DB_PASSWORD
        sync: false
      
      # Groq AIè¨­å®šï¼ˆé‹å–¶è€…ãŒè¨­å®šï¼‰
      - key: GROQ_API_KEY
        sync: false  # æ‰‹å‹•ã§è¨­å®š
      
      # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
      - key: SECRET_KEY
        generateValue: true
      
      # ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸è¨­å®šï¼ˆVPSç”¨ã«å¤‰æ›´ï¼‰
      - key: STORAGE_MODE
        value: vps_postgresql
      
      - key: OPERATOR_BLIND_ENABLED
        value: true
      
      # æš—å·åŒ–è¨­å®š
      - key: ENCRYPTION_LEVEL
        value: maximum
      
      - key: AUTO_DELETE_HOURS
        value: 24
      
      # CORSè¨­å®š
      - key: ALLOWED_ORIGINS
        value: https://x-automation-tool.onrender.com,http://localhost:3000
      
      # ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«
      - key: LOG_LEVEL
        value: INFO
      
      # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šè¨­å®š
      - key: DB_DEBUG
        value: false
      
      - key: DB_POOL_SIZE
        value: 5
      
      - key: DB_TIMEOUT
        value: 30
      
      # ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼è¨­å®š
      - key: PRIVACY_MODE
        value: operator_blind
      
      # Reactè¨­å®š
      - key: REACT_APP_API_URL
        value: https://x-automation-tool.onrender.com
      
      - key: REACT_APP_ENV
        value: production
      
      - key: REACT_APP_PRIVACY_MODE
        value: maximum
      
      - key: REACT_APP_OPERATOR_BLIND_MODE
        value: true
    
    # ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
    healthCheckPath: /api/system/health

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®šï¼ˆå‰Šé™¤ - VPSä½¿ç”¨ã®ãŸã‚ä¸è¦ï¼‰
# databases:
#   - name: x-automation-db
#     databaseName: x_automation_production
#     user: x_automation_user
#     plan: starter
#     postgresMajorVersion: 15

# ç’°å¢ƒè¨­å®š
environments:
  production:
    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
    security:
      - encrypted_storage: true
      - operator_blind: true
      - privacy_level: maximum
    
    # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨­å®š
    performance:
      - auto_scaling: true
      - health_checks: true
      - zero_downtime: true

# ãƒ“ãƒ«ãƒ‰è¨­å®š
build:
  # Pythonä¾å­˜é–¢ä¿‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥
  python:
    cache: true
    version: 3.11
  
  # Node.jsä¾å­˜é–¢ä¿‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥
  node:
    cache: false  # package-lock.jsonå•é¡Œå›é¿ã®ãŸã‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç„¡åŠ¹
    version: 18

# ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆè¨­å®š
deployment:
  # è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
  auto_deploy:
    branch: main
    enabled: true
  
  # ãƒ“ãƒ«ãƒ‰æœ€é©åŒ–
  optimization:
    - minify_assets: true
    - compress_responses: true
    - cache_static_assets: true

# é€šçŸ¥è¨­å®š
notifications:
  # ãƒ‡ãƒ—ãƒ­ã‚¤é€šçŸ¥
  deploy:
    enabled: true
    channels:
      - email

# ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒ»ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹è¨­å®š
privacy:
  # ãƒ‡ãƒ¼ã‚¿ä¿è­·
  data_protection:
    - encryption_at_rest: true
    - encryption_in_transit: true
    - automatic_deletion: true
  
  # ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
  access_control:
    - operator_blind_storage: true
    - user_controlled_deletion: true
    - no_operator_access: true

# è²»ç”¨æœ€é©åŒ–
cost_optimization:
  # ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†
  resources:
    - auto_sleep: true
    - efficient_scaling: true
    - minimal_resources: true
  
  # ç„¡æ–™ãƒ—ãƒ©ãƒ³æ´»ç”¨ï¼ˆVPSä½¿ç”¨ã«ã‚ˆã‚ŠPostgreSQLã‚³ã‚¹ãƒˆå‰Šæ¸›ï¼‰
  free_tier:
    - web_service: 750æ™‚é–“/æœˆ
    - bandwidth: 100GB/æœˆ
    - external_database: VPS PostgreSQL

# é‹ç”¨è¨­å®š
operations:
  # ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆVPSå´ã§ç®¡ç†ï¼‰
  backup:
    enabled: false  # VPSå´ã§å®Ÿè£…
    note: "VPSå´ã§cronã«ã‚ˆã‚‹æ—¥æ¬¡ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Ÿæ–½"

# é–‹ç™ºè€…å‘ã‘æƒ…å ±
developer_info:
  documentation: https://github.com/lilseedabe/x-automation-tool
  support: GitHub Issues
  license: MIT
  privacy_policy: é‹å–¶è€…ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰è¨­è¨ˆã«ã‚ˆã‚Šæœ€é«˜ãƒ¬ãƒ™ãƒ«ã®ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·
  database_info: "å¤–éƒ¨VPS PostgreSQLä½¿ç”¨"
  
# æ³¨æ„äº‹é …
notes: |
  ğŸ” ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼é‡è¦–è¨­è¨ˆ:
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®APIã‚­ãƒ¼ã¯é‹å–¶è€…ãŒã‚¢ã‚¯ã‚»ã‚¹ä¸å¯
  - æš—å·åŒ–ã•ã‚ŒãŸçŠ¶æ…‹ã§ã®ã¿ä¿å­˜
  - è‡ªå‹•å‰Šé™¤æ©Ÿèƒ½ã«ã‚ˆã‚Šé•·æœŸä¿å­˜ãªã—
  
  ğŸ’° è²»ç”¨åŠ¹ç‡:
  - Renderã®ç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼ˆWebã‚µãƒ¼ãƒ“ã‚¹ã¨CDNï¼‰
  - å¤–éƒ¨VPS PostgreSQLï¼ˆæœˆé¡1,000å††ï¼‰
  - åˆè¨ˆ: æœˆé¡ç´„1,000å††ã§å®Œå…¨ãªãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·
  
  ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹:
  - å¤–éƒ¨VPS PostgreSQL 16ä½¿ç”¨
  - Renderã®åˆ¶é™ã‚’å—ã‘ãªã„ç‹¬ç«‹ã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
  - é‹å–¶è€…ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰æš—å·åŒ–å¯¾å¿œ
  
  ğŸš€ é«˜å¯ç”¨æ€§:
  - ã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãƒ‡ãƒ—ãƒ­ã‚¤
  - è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
  - ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ç›£è¦–
  
  ğŸ”§ ãƒ“ãƒ«ãƒ‰ä¿®æ­£:
  - package-lock.jsonå‰Šé™¤ã§ä¾å­˜é–¢ä¿‚å•é¡Œè§£æ±º
  - npm install ã§æœ€æ–°ä¾å­˜é–¢ä¿‚å–å¾—
  - Node.jsã‚­ãƒ£ãƒƒã‚·ãƒ¥ç„¡åŠ¹åŒ–
